<html>

  <head>
    <meta charset='utf-8' />
    <meta
      name='viewport'
      content='width=device-width, initial-scale=1, shrink-to-fit=no'
    />
    <title>chat bot</title>
    <link
      href='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css'
      rel='stylesheet'
      integrity='sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC'
      crossorigin='anonymous'
    />
    <script 
      src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/js/all.min.js" 
      integrity="sha512-naukR7I+Nk6gp7p5TMA4ycgfxaZBJ7MO5iC3Fp6ySQyKFHOGfpkSZkYVWV5R7u7cfAicxanwYQ5D1e17EfJcMA==" 
      crossorigin="anonymous" 
      referrerpolicy="no-referrer"
    ></script>
    <link rel="stylesheet" href="/stylesheets/style.css">
    <script src="/main.js"></script>
  </head>

  <body class='d-flex flex-column h-100 bg-light'>
    {{> header}}
    <main role='main' class='flex-shrink-0'>
      <div class='album bg-light pt-5'>
        <div class='container'>
          <div class='pt-5'>
            {{> messages}}
            {{{body}}}
          </div>
        </div>
      </div>
    </main>
    {{> footer}}

    {{#if isAuthenticated}}
      <!-- 導入webchat視窗 -->
      <script>!(function () {
        let e = document.createElement("script"),
          t = document.head || document.getElementsByTagName("head")[0];
        (e.src =
          "http://cdn.jsdelivr.net/npm/rasa-webchat@1.0.1/lib/index.js"),
          // Replace 1.x.x with the version that you want
          (e.async = !0),
          (e.onload = () => {
            window.WebChat.default(
              {
                customData: { "language": "zh", "userId": `{{user.cpnyId}}`},
                initPayload: "/get_started",
                socketUrl: "http://192.168.10.105:5005",
                // socketPath: "/socket.io/",
                profileAvatar: "/images/jennyhire.jpg",
                inputTextFieldHint: "請輸入內容....",
                title: `[測試版]{{user.cpnyName}}小幫手`,
                subtitle: "",
                params: { "storage": "session" },
                showFullScreenButton: true,
                showCloseButton: true,
                showMessageDate: true,
                // embedded: true,
                // add other props here
              },
              null
            );
          }),
          t.insertBefore(e, t.firstChild);
          // 只要重整就刪除對話紀錄
          window.sessionStorage.clear()
      })();
    </script>
    {{/if}}
    <script
      src='https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js'
      integrity='sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p'
      crossorigin='anonymous'
    ></script>
    <script
      src='https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js'
      integrity='sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF'
      crossorigin='anonymous'
    ></script>
  </body>

</html>